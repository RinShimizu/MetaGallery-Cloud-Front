<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script> <!-- å¼•å…¥ crypto-js -->
    <link rel="icon" href="äº‘ç›˜.svg" type="image/x-icon">
    <title>ä¸ªäººä¸»é¡µ</title>
    <style>
        /* è®¾ç½®é¡µé¢èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰² */
        body {
            background-color: #ffffff; /* ç™½è‰² */
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            height: 100vh; /* è®© body å æ»¡æ•´ä¸ªè§†çª—é«˜åº¦ */
            display: flex;
            flex-direction: column; /* ä½¿å†…å®¹å‚ç›´æ’åˆ— */
            align-items: center; /* å†…å®¹æ°´å¹³å±…ä¸­ */
            position: relative; /* ä½¿å­å…ƒç´ å¯ä»¥ç»å¯¹å®šä½ */
        }

        /* æ‚¬æµ®æ¡†æ ·å¼ */
        .floating-box {
            display: none; /* åˆå§‹ä¸æ˜¾ç¤º */
            position: absolute; /* ç»å¯¹å®šä½ */
            top: 100px; /* æ‚¬æµ®æ¡†é¡¶éƒ¨è·ç¦» */
            right: 30px; /* æ‚¬æµ®æ¡†å³ä¾§è·ç¦» */
            width: 150px; /* æ‚¬æµ®æ¡†å®½åº¦ */
            padding: 10px; /* å†…è¾¹è· */
            background-color: white; /* èƒŒæ™¯é¢œè‰² */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* é˜´å½±æ•ˆæœ */
            border-radius: 10px; /* åœ†è§’ */
            z-index: 1000; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        }

        .floating-box button {
            width: 100%; /* æŒ‰é’®å®½åº¦ */
            padding: 10px; /* æŒ‰é’®å†…è¾¹è· */
            border: none; /* æ— è¾¹æ¡† */
            border-radius: 5px; /* åœ†è§’ */
            background-color: #007bff; /* æŒ‰é’®èƒŒæ™¯é¢œè‰² */
            color: white; /* æŒ‰é’®æ–‡å­—é¢œè‰² */
            cursor: pointer; /* é¼ æ ‡æ ·å¼ */
        }

        /* é¡¶éƒ¨ç©ºç™½æ¡†æ ·å¼ */
        .top-box {
            width: 100%; /* ä¸é¡µé¢ä¸€æ ·å®½ */
            height: 80px; /* é«˜åº¦ */
            background-color: #ffffff; /* èƒŒæ™¯è‰² */
            display: flex; /* ä½¿å†…å®¹å¯å±…ä¸­ */
            align-items: center; /* å†…å®¹å‚ç›´å±…ä¸­ */
            justify-content: space-between; /* å†…å®¹ä¸¤ç«¯å¯¹é½ */
            padding: 0 20px; /* å·¦å³å†…è¾¹è· */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* é˜´å½±æ•ˆæœ */
        }

        /* é¡¶éƒ¨å›¾æ ‡æ ·å¼ */
        .top-icon {
            width: 200px; /* å›¾æ ‡å®½åº¦ */
            height: 50px; /* å›¾æ ‡é«˜åº¦ */
        }

        input[type="password"]::-ms-reveal,
        input[type="password"]::-ms-clear {
            display: none;
        }
        /* å³ä¾§å°å›¾æ ‡å®¹å™¨æ ·å¼ */
        .small-icons {
            display: flex; /* ä½¿å°å›¾æ ‡æ°´å¹³æ’åˆ— */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-right: 50px; /* è·ç¦»å³è¾¹ç•Œ10px */
        }

        /* å°å›¾æ ‡æ ·å¼ */
        .small-icon {
            width: 50px; /* å°å›¾æ ‡å®½åº¦ */
            height: 50px; /* å°å›¾æ ‡é«˜åº¦ */
            margin-left: 100px; /* å°å›¾æ ‡é—´è· */
        }

        /* ç©ºç™½æ¡†æ ·å¼ */
        .box {
            width: 900px; /* æ¡†å®½åº¦ */
            height: 550px; /* æ¡†é«˜åº¦ */
            background-color: #f3fbfe; /* æ¡†èƒŒæ™¯è‰² */
            border-radius: 20px; /* åœ†è§’åŠå¾„ */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* é˜´å½±æ•ˆæœ */
            display: flex; /* ä½¿å†…å®¹å¯å±…ä¸­ */
            justify-content: flex-start; /* å†…å®¹å·¦å¯¹é½ */
            align-items: flex-start; /* å†…å®¹é¡¶éƒ¨å¯¹é½ */
            position: relative; /* ä½¿å›¾æ ‡å’Œæ–‡æœ¬ç›¸å¯¹äºæ¡†å®šä½ */
            margin-top: 80px; /* ä¸é¡¶éƒ¨æ¡†çš„é—´è· */
            padding: 20px; /* å†…è¾¹è· */
        }

        /* å›¾æ ‡æ ·å¼ */
        .icon {
            position: absolute; /* ç»å¯¹å®šä½ */
            top: -40px; /* è·ç¦»æ¡†é¡¶éƒ¨20åƒç´  */
            left: 20px; /* è·ç¦»å·¦è¾¹20åƒç´  */
            width: 40px; /* å›¾æ ‡å®½åº¦ */
            height: 40px; /* å›¾æ ‡é«˜åº¦ */
        }

        /* æ–‡æœ¬æ ·å¼ */
        .text {
            position: absolute; /* ç»å¯¹å®šä½ */
            top: -40px; /* è·ç¦»æ¡†é¡¶éƒ¨ï¼Œä¿æŒä¸å›¾æ ‡å¯¹é½ */
            left: 70px; /* è·ç¦»å·¦è¾¹70åƒç´ ï¼Œä¿è¯ä¸å›¾æ ‡æœ‰é—´è· */
            font-size: 23px; /* å­—ä½“å¤§å° */
            color: #7e7b7b; /* å­—ä½“é¢œè‰² */
        }

        /* è¾“å…¥æ¡†å®¹å™¨æ ·å¼ */
        .input-container {
            margin-left: 500px; /* è°ƒæ•´è¾“å…¥æ¡†çš„å·¦ä¾§ä½ç½® */
            margin-top: 50px; /* è¾“å…¥æ¡†ä¸é¡¶éƒ¨çš„é—´è· */
            display: flex; /* ä½¿è¾“å…¥æ¡†å’Œæ ‡ç­¾åœ¨åŒä¸€è¡Œ */
            flex-direction: column; /* ç«–æ’ */
            align-items: flex-end; /* å³å¯¹é½ */
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .input {
            width: 300px; /* è¾“å…¥æ¡†å®½åº¦ */
            height: 30px; /* è¾“å…¥æ¡†é«˜åº¦ */
            border-radius: 15px; /* åœ†è§’åŠå¾„ */
            border: 1px solid #ccc; /* è¾¹æ¡† */
            margin-bottom: 30px; /* è¾“å…¥æ¡†ä¹‹é—´çš„é—´è· */
            padding: 5px; /* å†…è¾¹è· */
        }

        /* æ ‡ç­¾æ ·å¼ */
        .label {
            display: flex; /* ä½¿æ ‡ç­¾å’Œè¾“å…¥æ¡†å¹¶æ’ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-bottom: 10px; /* æ ‡ç­¾ä¸è¾“å…¥æ¡†ä¹‹é—´çš„é—´è· */
        }

        /* è´¦å·éƒ¨åˆ†æ ·å¼ */
        .account-label {
            position: absolute; /* ç»å¯¹å®šä½ */
            top: 320px; /* è·ç¦»æ¡†é¡¶éƒ¨ */
            left: 150px; /* è·ç¦»æ¡†å·¦ä¾§ */
            font-size: 18px; /* å­—ä½“å¤§å° */
            color: #7e7b7b; /* å­—ä½“é¢œè‰² */
        }

        /* ä¿®æ”¹ accountAvatarImage çš„æ ·å¼ */
        //#accountAvatarImage {
        //    position: absolute; /* ç»å¯¹å®šä½ */
        //    top: 200px; /* è°ƒæ•´é¡¶éƒ¨ä½ç½® */
        //    left: 170px; /* è°ƒæ•´å·¦ä¾§ä½ç½® */
        //    width: 700px; /* ä¿®æ”¹ä¸ºæ‰€éœ€å®½åº¦ */
        //    height: 700px; /* ä¿®æ”¹ä¸ºæ‰€éœ€é«˜åº¦ */
        //    border-radius: 50%; /* åœ†å½¢å¤´åƒ */
        //    //margin-bottom: 10px; /* ä¸ä¸‹é¢å…ƒç´ çš„é—´è· */
        //}

        .avatar-image {
            position: absolute; /* ç»å¯¹å®šä½ */
            top: 130px; /* è°ƒæ•´é¡¶éƒ¨ä½ç½® */
            left: 150px; /* è°ƒæ•´å·¦ä¾§ä½ç½® */
            width: 150px; /* éœ€è¦çš„å®½åº¦ */
            height: 150px; /* éœ€è¦çš„é«˜åº¦ */
            border-radius: 50%; /* åœ†å½¢å¤´åƒ */
            margin-bottom: 10px; /* ä¸ä¸‹é¢å…ƒç´ çš„é—´è· */
        }

        .account-value {
            position: absolute; /* ç»å¯¹å®šä½ */
            top: 360px; /* è·ç¦»æ¡†é¡¶éƒ¨ */
            left: 100px; /* è·ç¦»æ¡†å·¦ä¾§ */
            width: 250px; /* å®½åº¦ */
            height: 50px; /* é«˜åº¦ */
            border-radius: 15px; /* åœ†è§’åŠå¾„ */
            border: 1px solid #ccc; /* è¾¹æ¡† */
            display: flex; /* ä½¿å†…å®¹å¯å±…ä¸­ */
            justify-content: center; /* å†…å®¹æ°´å¹³å±…ä¸­ */
            align-items: center; /* å†…å®¹å‚ç›´å±…ä¸­ */
            background-color: #ffffff; /* èƒŒæ™¯è‰² */
        }

        /* æŒ‰é’®æ ·å¼ */
        .button {
            width: 100px; /* æŒ‰é’®å®½åº¦ */
            height: 40px; /* æŒ‰é’®é«˜åº¦ */
            border-radius: 15px; /* åœ†è§’åŠå¾„ */
            border: none; /* æ— è¾¹æ¡† */
            color: white; /* å­—ä½“é¢œè‰² */
            background-color: #007bff; /* èƒŒæ™¯é¢œè‰² */
            margin-right: 40px; /* æŒ‰é’®é—´è· */
        }

        /* æŒ‰é’®å®¹å™¨æ ·å¼ */
        .button-container {
            display: flex; /* ä½¿æŒ‰é’®æ°´å¹³æ’åˆ— */
            margin-top: 20px; /* æŒ‰é’®ä¸è¾“å…¥æ¡†çš„é—´è· */
        }

        /* çœ¼ç›å›¾æ ‡æ ·å¼ */
        .toggle-password-btn {
            position: absolute;
            right: 10px; /* è°ƒæ•´åˆ°è¾“å…¥æ¡†çš„å³è¾¹ */
            top: 5px; /* è°ƒæ•´å›¾æ ‡çš„å‚ç›´ä½ç½® */
            cursor: pointer;
            font-size: 16px; /* å›¾æ ‡å¤§å° */
            color: #aaa; /* å›¾æ ‡é¢œè‰² */
        }
    </style>
</head>
<body>
<div class="top-box">
    <img src="img1.png" alt="é¡¶éƒ¨å›¾æ ‡" class="top-icon" />
    <div class="small-icons">
        <img src="small-icon1.svg" alt="å°å›¾æ ‡1" class="small-icon" />

        <img id="avatarImage" src="small-icon2.png" alt="Avatar" style="width: 60px; height: 60px; border-radius: 50%; cursor: pointer;">
    </div>
</div>
<div class="box">
    <img src="img.png" alt="å›¾æ ‡" class="icon" />
    <span class="text">ä¸ªäººä¸­å¿ƒ</span> <!-- æ·»åŠ çš„æ–‡æœ¬ -->

    <!-- è´¦å·éƒ¨åˆ† -->
    <img id="accountAvatarImage" src="small-icon2.png" alt="Avatar" class="avatar-image"> <!-- æ–°å¢å¤´åƒ -->
    <span class="account-label">è´¦å·ï¼šï¼ˆä¸å¯ä¿®æ”¹ï¼‰</span>
    <div class="account-value" id="accountValue">ä¸å¯ä¿®æ”¹</div>

    <!-- è¾“å…¥æ¡†éƒ¨åˆ† -->
    <div class="input-container">
        <div class="label">
            <span>æ˜µç§°ï¼š</span>
            <input type="text" class="input" id="nickname" placeholder="å¦‚ä¸ä¿®æ”¹æ˜µç§°ï¼Œæ­¤æ¡†å¯ä¸å†™" />
        </div>
        <div class="label">
            <span>ä¸ªæ€§ç­¾åï¼š</span>
            <input type="text" class="input" id="signature" placeholder="è¿™ä¸ªäººå¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰å†™~" />
        </div>
        <div class="label">
            <span>åŸå¯†ç ï¼š</span>
            <div style="position: relative;">
                <input type="password" class="input" id="oldpwd" placeholder="å¦‚ä¸ä¿®æ”¹å¯†ç ï¼Œæ­¤æ¡†å¯ä¸å†™" />
                <span class="toggle-password-btn" onclick="togglePasswordVisibility('oldpwd', this)">ğŸ‘ï¸</span>
            </div>
        </div>
        <div class="label">
            <span>ä¿®æ”¹å¯†ç ï¼š</span>
            <div style="position: relative;">
                <input type="password" class="input" id="newpwd" placeholder="å¦‚ä¸ä¿®æ”¹å¯†ç ï¼Œæ­¤æ¡†å¯ä¸å†™" />
                <span class="toggle-password-btn" onclick="togglePasswordVisibility('newpwd', this)">ğŸ‘ï¸</span>
            </div>
        </div>
        <div class="label">
            <span>ç¡®è®¤å¯†ç ï¼š</span>
            <div style="position: relative;">
                <input type="password" class="input" id="confirmnewpwd" placeholder="å¦‚ä¸ä¿®æ”¹å¯†ç ï¼Œæ­¤æ¡†å¯ä¸å†™" />
                <span class="toggle-password-btn" onclick="togglePasswordVisibility('confirmnewpwd', this)">ğŸ‘ï¸</span>
            </div>
        </div>

        <!-- æŒ‰é’®éƒ¨åˆ† -->
        <div class="button-container">
            <button class="button" id="confirmButton">ç¡®è®¤</button>
            <button class="button" id="cancelButton">å–æ¶ˆ</button>
        </div>
    </div>
</div>

<!-- æ‚¬æµ®æ¡† -->
<div class="floating-box" id="floatingBox">
    <button id="logoutButton">é€€å‡º</button>
</div>

<script>

    function togglePasswordVisibility(inputId, iconElement) {
        const inputField = document.getElementById(inputId);
        if (inputField.type === "password") {
            inputField.type = "text"; // å°†å¯†ç è¾“å…¥æ¡†æ”¹ä¸ºå¯è§
            iconElement.textContent = "ğŸ‘ï¸"; // ä¿®æ”¹ä¸ºå¯è§å›¾æ ‡
        } else {
            inputField.type = "password"; // å°†å¯†ç è¾“å…¥æ¡†æ”¹ä¸ºä¸å¯è§
            iconElement.textContent = "ğŸ™ˆ"; // ä¿®æ”¹ä¸ºéšç§å›¾æ ‡
        }
    }
    document.addEventListener("DOMContentLoaded", function () {

        // è®¾ç½®å¯†ç è¾“å…¥æ¡†å›¾æ ‡ä¸º ğŸ™ˆ
        const passwordInputs = ['oldpwd', 'newpwd', 'confirmnewpwd'];
        passwordInputs.forEach(inputId => {
            const inputField = document.getElementById(inputId);
            const iconElement = document.querySelector(`.toggle-password-btn[onclick*="${inputId}"]`);
            if (inputField) {
                inputField.type = "password"; // ç¡®ä¿è¾“å…¥æ¡†æ˜¯ä¸å¯è§çš„
                if (iconElement) {
                    iconElement.textContent = "ğŸ™ˆ"; // è®¾ç½®å›¾æ ‡ä¸º ğŸ™ˆ
                }
            }
        });

        // æ˜¾ç¤ºæ‚¬æµ®æ¡†
        const avatarImage = document.getElementById('avatarImage');
        const floatingBox = document.getElementById('floatingBox'); // ç¡®ä¿æœ‰ä¸€ä¸ªæ‚¬æµ®æ¡†çš„å…ƒç´ 

        avatarImage.addEventListener('click', function () {
            // åˆ‡æ¢æ‚¬æµ®æ¡†æ˜¾ç¤º
            if (floatingBox.style.display === 'none' || floatingBox.style.display === '') {
                floatingBox.style.display = 'block'; // æ˜¾ç¤ºæ‚¬æµ®æ¡†
            } else {
                floatingBox.style.display = 'none'; // éšè—æ‚¬æµ®æ¡†
            }
        });

        // é€€å‡ºæŒ‰é’®äº‹ä»¶
        const logoutButton = document.getElementById('logoutButton');
        logoutButton.addEventListener('click', function () {
            // è¿™é‡Œå¯ä»¥æ‰§è¡Œé€€å‡ºé€»è¾‘ï¼Œæ¯”å¦‚æ¸…é™¤ token ç­‰
            localStorage.removeItem('token'); // ç¤ºä¾‹ï¼šæ¸…é™¤ token
            window.location.href = '../homepage.html'; // è·³è½¬åˆ°ä¸Šä¸€ä¸ªé¡µé¢ï¼ˆæ›¿æ¢ä¸ºå®é™…é¡µé¢ï¼‰
        });

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹éšè—æ‚¬æµ®æ¡†
        document.addEventListener('click', function (event) {
            if (!avatarImage.contains(event.target) && !floatingBox.contains(event.target)) {
                floatingBox.style.display = 'none'; // éšè—æ‚¬æµ®æ¡†
            }
        });

        // ä» localStorage ä¸­è¯»å– userData
        const userData = JSON.parse(localStorage.getItem('userData'));
        console.log("ä» localStorage è¯»å–åˆ°çš„æ•°æ®:", userData);

        // const token = localStorage.getItem('token');
        // console.log("è·å–åˆ°çš„ token:", token);
        if (userData && userData.data && userData.data.userInfo) {
            // è·å–åµŒå¥—çš„ userInfo
            const userInfo = userData.data.userInfo;

            // è·å–è¦å¡«å……çš„å…ƒç´ 
            const accountValueElement = document.getElementById('accountValue');
            const nicknameElement = document.getElementById('nickname');
            const signatureElement = document.getElementById('signature');
            const avatarImage = document.getElementById('avatarImage');
            const accountAvatarImage = document.getElementById('accountAvatarImage'); // ä¿®æ”¹ä¸ºæ–°çš„ ID

            if (accountValueElement) {
                accountValueElement.textContent = userInfo.account || 'ä¸å¯ä¿®æ”¹';
                console.log("accountValue å¡«å……æˆåŠŸ:", userInfo.account);
            } else {
                console.error("accountValue å…ƒç´ æœªæ‰¾åˆ°");
            }

            if (nicknameElement) {
                nicknameElement.value = userInfo.name || '';
                console.log("nickname å¡«å……æˆåŠŸ:", userInfo.name);
            } else {
                console.error("nickname å…ƒç´ æœªæ‰¾åˆ°");
            }

            if (signatureElement) {
                signatureElement.value = userInfo.intro || '';
                console.log("signature å¡«å……æˆåŠŸ:", userInfo.intro);
            } else {
                console.error("signature å…ƒç´ æœªæ‰¾åˆ°");
            }
            if (avatarImage) {
                // ä½¿ç”¨ userInfo.avatar æ›¿æ¢ small-icon2.png
                avatarImage.src = userInfo.avatar || 'small-icon2.png';
                console.log("å¤´åƒå·²æˆåŠŸæ›´æ–°ä¸º:", userInfo.avatar);
            } else {
                console.error("æ‰¾ä¸åˆ°å¤´åƒ img å…ƒç´ ");
            }
            if (accountAvatarImage) {
                // ä½¿ç”¨ userInfo.avatar æ›¿æ¢ small-icon2.png
                accountAvatarImage.src = userInfo.avatar || 'small-icon2.png';
                console.log("å¤´åƒå·²æˆåŠŸæ›´æ–°ä¸º:", userInfo.avatar);
            } else {
                console.error("æ‰¾ä¸åˆ°å¤´åƒ img å…ƒç´ ");
            }

            // ç¡®è®¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const confirmButton = document.getElementById('confirmButton');
            confirmButton.addEventListener('click', function () {
                const oldPassword = document.getElementById('oldpwd').value; // åŸå¯†ç 
                const newPassword = document.getElementById('newpwd').value; // ä¿®æ”¹å¯†ç 
                const confirmPassword = document.getElementById('confirmnewpwd').value; // ç¡®è®¤å¯†ç 

                if (oldPassword && newPassword && confirmPassword){
                    // è¿›è¡Œ SHA-256 åŠ å¯†
                    const encryptedoldPassword = CryptoJS.SHA256(oldPassword).toString(CryptoJS.enc.Base64);
                    const encryptednewPassword = CryptoJS.SHA256(newPassword).toString(CryptoJS.enc.Base64);
                    const encryptedconPassword = CryptoJS.SHA256(confirmPassword).toString(CryptoJS.enc.Base64);
                    const formData1 = new FormData();
                    formData1.append('account', userInfo.account); // è´¦å·ï¼ˆä¸å¯ä¿®æ”¹ï¼‰
                    formData1.append('old_password', encryptedoldPassword); // åŸå¯†ç 
                    formData1.append('new_password', encryptednewPassword); // ä¿®æ”¹å¯†ç 
                    formData1.append('confirm_password', encryptedconPassword);//ç¡®è®¤å¯†ç 

                    fetch('http://127.0.0.1:8080/api/updatePassword', {
                        method: 'POST', // æ ¹æ®ä½ çš„åç«¯æ¥å£è¦æ±‚ä½¿ç”¨ç›¸åº”çš„ HTTP æ–¹æ³•
                        headers: {
                            //'Content-Type': 'application/json', // å‘é€ JSON æ•°æ®
                            'Authorization':  localStorage.getItem('token'), // åŒ…å« Token
                        },
                        body: formData1, // å°†æ›´æ–°çš„æ•°æ®è½¬ä¸º JSON å­—ç¬¦ä¸²
                    })
                        .then(response => {
                            console.log('å“åº”å¯¹è±¡:', response);
                            if (!response.ok) {
                                throw new Error('ç½‘ç»œå“åº”ä¸æ˜¯ OK');
                            }
                            return response.json(); // è§£æå“åº”ä¸º JSON
                        })
                        .then(data => {
                            console.log('æˆåŠŸ:', data);
                            alert(data.msg)
                        })
                        .catch((error) => {
                            console.error('å‘ç”Ÿé”™è¯¯:', error);
                            // åœ¨è¿™é‡Œå¯ä»¥å¤„ç†é”™è¯¯åé¦ˆï¼Œæ¯”å¦‚æç¤ºç”¨æˆ·æ›´æ–°å¤±è´¥
                        });

                }
                const formData = new FormData();
                formData.append('account', userInfo.account); // è´¦å·ï¼ˆä¸å¯ä¿®æ”¹ï¼‰
                formData.append('name', document.getElementById('nickname').value); // æ˜µç§°
                formData.append('info', document.getElementById('signature').value); // ä¸ªæ€§ç­¾å
                const nickname = document.getElementById('nickname').value;
                const signature = document.getElementById('signature').value;
                if(nickname!==userInfo.name||signature!==userInfo.intro){
                    // ä½¿ç”¨ fetch å‘é€ POST è¯·æ±‚åˆ° UpdateUserInfo æ¥å£
                    fetch('http://127.0.0.1:8080/api/updateProfile', {
                        method: 'POST', // æ ¹æ®ä½ çš„åç«¯æ¥å£è¦æ±‚ä½¿ç”¨ç›¸åº”çš„ HTTP æ–¹æ³•
                        headers: {
                            //'Content-Type': 'application/json', // å‘é€ JSON æ•°æ®
                            'Authorization':  localStorage.getItem('token'), // åŒ…å« Token
                        },
                        body: formData, // å°†æ›´æ–°çš„æ•°æ®è½¬ä¸º JSON å­—ç¬¦ä¸²
                    })
                        .then(response => {
                            console.log('å“åº”å¯¹è±¡:', response);
                            if (!response.ok) {
                                throw new Error('ç½‘ç»œå“åº”ä¸æ˜¯ OK');
                            }
                            return response.json(); // è§£æå“åº”ä¸º JSON
                        })
                        .then(data => {
                            console.log('æˆåŠŸ:', data);
                            alert(data.msg)
                            if(data.status==='SUCCESS'){
                                //localStorage.setItem('userData', JSON.stringify(data));
                                userData.data.userInfo.name = nickname; // æ›´æ–°æ˜µç§°
                                userData.data.userInfo.intro = signature; // æ›´æ–°ä¸ªæ€§ç­¾å
                                localStorage.setItem('userData', JSON.stringify(userData)); // ä¿å­˜æ›´æ–°åçš„æ•°æ®
                                console.log("localStorage æ›´æ–°æˆåŠŸ:", userData);
                            }
                        })
                        .catch((error) => {
                            console.error('å‘ç”Ÿé”™è¯¯:', error);
                            // åœ¨è¿™é‡Œå¯ä»¥å¤„ç†é”™è¯¯åé¦ˆï¼Œæ¯”å¦‚æç¤ºç”¨æˆ·æ›´æ–°å¤±è´¥
                        });
                }
                if (!oldPassword && !newPassword && !confirmPassword && nickname===userInfo.name && signature===userInfo.intro){
                    alert('æ‚¨æœªä½œå‡ºä»»ä½•ä¿®æ”¹ï¼')
                }
            });

            // å–æ¶ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const cancelButton = document.getElementById('cancelButton');
            cancelButton.addEventListener('click', function (){
                location.reload(); // é‡æ–°åŠ è½½é¡µé¢
            });
        } else {
            console.error("ç”¨æˆ·æ•°æ®æœªæ‰¾åˆ°æˆ–æ•°æ®æ ¼å¼ä¸æ­£ç¡®");
        }
    });

</script>
</body>
</html>
